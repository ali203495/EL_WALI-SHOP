import{_ as ne}from"./Y6lJhnZ0.js";import{d as T,u as A,J as oe,A as J,m as Q,r as f,c as v,b as c,D as E,e,s as k,t as a,h as t,v as x,I as G,F as B,G as F,q as P,W as se,n as S,j as L,T as X,C as K,H,a1 as Y,g as Z,i as V,a2 as ie,w as I,z as de,M as ue,X as re,o as ce}from"./CKlka8Zi.js";const me={class:"form-grid"},pe={class:"form-group full-width"},ve={class:"form-group full-width"},_e={class:"form-group"},fe={class:"form-group"},ge={class:"form-group"},be={value:null},ye=["value"],he={class:"form-group"},ke={value:null},$e=["value"],Ce={class:"form-group full-width"},we={class:"image-input-type"},Ve={key:0,class:"mt-2"},xe={key:1,class:"mt-2 upload-container"},Se={key:0,class:"upload-status"},Pe={key:1,class:"preview"},Me=["src"],Ue={class:"form-actions"},qe={type:"submit",class:"btn btn-primary"},De=T({__name:"ProductForm",props:{product:{},categories:{},brands:{}},emits:["submit","cancel"],setup(m,{emit:l}){const{translateLanguage:i}=A(),p=m,_=l,d=oe({id:p.product?.id,name:p.product?.name||"",description:p.product?.description||"",price:p.product?.price||0,stock:p.product?.stock||0,image_url:p.product?.image_url||"",category_id:p.product?.category_id||null,brand_id:p.product?.brand_id||null}),g=J(()=>!!p.product?.id),b=Q(),y=f("url"),$=f(!1),C=f(null),M=()=>{_("submit",{...d})},U=async w=>{const s=w.target;if(s.files&&s.files[0]){$.value=!0;try{const n=await b.uploadImage(s.files[0]);d.image_url=n}catch{alert("Failed to upload image")}finally{$.value=!1}}};return(w,s)=>(c(),v("form",{onSubmit:E(M,["prevent"]),class:"product-form"},[e("div",me,[e("div",pe,[e("label",null,a(t(i)("admin.name"))+" *",1),k(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t(d).name=n),type:"text",required:"",class:"input-field"},null,512),[[x,t(d).name]])]),e("div",ve,[e("label",null,a(t(i)("admin.description")),1),k(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=n=>t(d).description=n),rows:"3",class:"input-field"},null,512),[[x,t(d).description]])]),e("div",_e,[e("label",null,a(t(i)("admin.price"))+" *",1),k(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>t(d).price=n),type:"number",min:"0",step:"0.01",required:"",class:"input-field"},null,512),[[x,t(d).price]])]),e("div",fe,[e("label",null,a(t(i)("admin.stock"))+" *",1),k(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>t(d).stock=n),type:"number",min:"0",required:"",class:"input-field"},null,512),[[x,t(d).stock]])]),e("div",ge,[e("label",null,a(t(i)("admin.category")),1),k(e("select",{"onUpdate:modelValue":s[4]||(s[4]=n=>t(d).category_id=n),class:"input-field"},[e("option",be,a(t(i)("admin.select_category")),1),(c(!0),v(B,null,F(m.categories,n=>(c(),v("option",{key:n.id,value:n.id},a(n.name),9,ye))),128))],512),[[G,t(d).category_id]])]),e("div",he,[e("label",null,a(t(i)("admin.brand")),1),k(e("select",{"onUpdate:modelValue":s[5]||(s[5]=n=>t(d).brand_id=n),class:"input-field"},[e("option",ke,a(t(i)("admin.select_brand")),1),(c(!0),v(B,null,F(m.brands,n=>(c(),v("option",{key:n.id,value:n.id},a(n.name),9,$e))),128))],512),[[G,t(d).brand_id]])]),e("div",Ce,[e("label",null,a(t(i)("admin.image")),1),e("div",we,[e("button",{type:"button",class:P(["type-btn",{active:t(y)==="url"}]),onClick:s[6]||(s[6]=n=>y.value="url")},a(t(i)("admin.image_url")),3),e("button",{type:"button",class:P(["type-btn",{active:t(y)==="upload"}]),onClick:s[7]||(s[7]=n=>y.value="upload")},a(t(i)("admin.upload_image")),3)]),t(y)==="url"?(c(),v("div",Ve,[k(e("input",{"onUpdate:modelValue":s[8]||(s[8]=n=>t(d).image_url=n),type:"url",placeholder:"https://...",class:"input-field",style:se({direction:t(i)("common.direction")==="rtl"?"rtl":"ltr",textAlign:"left"})},null,4),[[x,t(d).image_url]])])):(c(),v("div",xe,[e("input",{type:"file",ref_key:"fileInput",ref:C,onChange:U,accept:"image/*",class:"file-input"},null,544),t($)?(c(),v("div",Se,a(t(i)("admin.uploading")),1)):S("",!0),t(d).image_url&&t(y)==="upload"?(c(),v("div",Pe,[e("img",{src:t(d).image_url,alt:"Preview"},null,8,Me)])):S("",!0)]))])]),e("div",Ue,[e("button",{type:"button",class:"btn btn-outline",onClick:s[9]||(s[9]=n=>_("cancel"))},a(t(i)("admin.cancel")),1),e("button",qe,a(t(g)?t(i)("admin.update_product"):t(i)("admin.add_product")),1)])],32))}}),Te=Object.assign(L(De,[["__scopeId","data-v-e294f455"]]),{__name:"ProductForm"}),Le={key:0,class:"modal-header"},ze={class:"modal-body"},Be={key:1,class:"modal-footer"},Fe=T({__name:"Modal",props:{modelValue:{type:Boolean},title:{},size:{}},emits:["update:modelValue","close"],setup(m,{emit:l}){const i=m,p=l,_=f(null),d=()=>{p("update:modelValue",!1),p("close")};return X(()=>i.modelValue,g=>{g&&_.value&&Z.from(_.value.querySelector(".modal-content"),{scale:.9,opacity:0,duration:.2,ease:"power2.out"})}),(g,b)=>(c(),K(Y,{to:"body"},[m.modelValue?(c(),v("div",{key:0,ref_key:"modalRef",ref:_,class:"modal-overlay",onClick:E(d,["self"])},[e("div",{class:P(["modal-content",[`modal-${m.size||"md"}`]])},[m.title?(c(),v("div",Le,[e("h3",null,a(m.title),1),e("button",{class:"close-btn",onClick:d},"Ã—")])):S("",!0),e("div",ze,[H(g.$slots,"default",{},void 0)]),g.$slots.footer?(c(),v("div",Be,[H(g.$slots,"footer",{},void 0)])):S("",!0)],2)],512)):S("",!0)]))}}),Ie=Object.assign(L(Fe,[["__scopeId","data-v-0086c375"]]),{__name:"Modal"}),Ae={class:"confirm-dialog"},Ee={class:"confirm-actions"},je=T({__name:"ConfirmDialog",props:{modelValue:{type:Boolean},title:{},message:{},confirmText:{},cancelText:{},danger:{type:Boolean}},emits:["update:modelValue","confirm","cancel"],setup(m,{emit:l}){const{translateLanguage:i}=A(),p=l,_=()=>{p("update:modelValue",!1),p("cancel")},d=()=>{p("update:modelValue",!1),p("confirm")};return(g,b)=>(c(),K(Y,{to:"body"},[V(ie,{name:"fade"},{default:I(()=>[m.modelValue?(c(),v("div",{key:0,class:"confirm-overlay",onClick:E(_,["self"])},[e("div",Ae,[e("div",{class:P(["confirm-icon",{danger:m.danger}])},a(m.danger?"âš ï¸":"â“"),3),e("h3",null,a(m.title||t(i)("admin.confirm_dialog.default_title")),1),e("p",null,a(m.message||t(i)("admin.confirm_dialog.default_message")),1),e("div",Ee,[e("button",{class:"btn btn-outline",onClick:_},a(m.cancelText||t(i)("admin.confirm_dialog.cancel")),1),e("button",{class:P(["btn",m.danger?"btn-danger":"btn-primary"]),onClick:d},a(m.confirmText||t(i)("admin.confirm_dialog.confirm")),3)])])])):S("",!0)]),_:1})]))}}),Ne=Object.assign(L(je,[["__scopeId","data-v-00aee70b"]]),{__name:"ConfirmDialog"}),Re={class:"content"},Oe={class:"page-header"},We={class:"subtitle"},Ge={class:"toolbar"},He={class:"search-wrapper"},Je=["placeholder"],Qe={class:"count"},Xe={class:"table-container"},Ke={key:0,class:"loading-state"},Ye={key:1,class:"empty-state"},Ze={key:2,class:"data-table"},et={class:"product-cell"},tt=["src","alt"],at={class:"product-name"},lt={class:"product-id"},nt={class:"price"},ot={class:"rating"},st={class:"actions"},it=["title","onClick"],dt=["title","onClick"],ut=T({__name:"products",setup(m){const{translateLanguage:l}=A(),i=de(),p=ue(),_=Q(),{success:d,error:g}=re(),b=f([]),y=f([]),$=f([]),C=f(!0),M=f(null),U=async()=>{C.value=!0,M.value=null;try{const[r,o,D]=await Promise.all([_.getProducts(),_.getCategories(),_.getBrands()]);if(r.error.value||o.error.value||D.error.value){M.value=r.error.value||o.error.value||D.error.value;return}b.value=r.data.value||[],y.value=o.data.value||[],$.value=D.data.value||[]}catch(r){M.value=r,console.error("Fetch products failed:",r)}finally{C.value=!1}};ce(()=>{U(),Z.from(".product-row",{x:-20,opacity:0,stagger:.03,duration:.4})});const w=f(""),s=f(!1),n=f(!1),q=f(!1),h=f(null),z=J(()=>{if(!b.value)return[];if(!w.value)return b.value;const r=w.value.toLowerCase();return b.value.filter(o=>o.name.toLowerCase().includes(r)||o.brand?.name.toLowerCase().includes(r))}),j=()=>{h.value=null,s.value=!0},N=r=>{h.value={...r},n.value=!0},ee=r=>{h.value=r,q.value=!0},R=async r=>{C.value=!0;try{h.value?.id?(await _.updateProduct(h.value.id,r),d(l("admin.save_success"))):(await _.createProduct(r),d(l("admin.save_success"))),s.value=!1,n.value=!1,await U()}catch(o){console.error(o),g(l("admin.save_failed"))}finally{C.value=!1}},te=async()=>{if(h.value?.id){try{await _.deleteProduct(h.value.id),d(l("admin.delete_success"))}catch(r){const o=r.data?.detail||l("admin.failed_load");g(o)}q.value=!1,h.value=null,await U()}};return X([b,()=>i.query.id],()=>{if(i.query.id&&b.value.length>0){const r=b.value.find(o=>o.id===Number(i.query.id));r&&(N(r),p.replace({query:{...i.query,id:void 0}}))}},{immediate:!0}),(r,o)=>{const D=ne,O=Te,W=Ie,ae=Ne;return c(),v("div",null,[e("main",Re,[e("header",Oe,[e("div",null,[e("h1",null,a(t(l)("admin.products")),1),e("p",We,a(t(l)("nav.admin_portal"))+" / "+a(t(l)("admin.products")),1)]),e("button",{class:"btn btn-primary",onClick:j},"+ "+a(t(l)("admin.add_product")),1)]),e("div",Ge,[e("div",He,[o[7]||(o[7]=e("span",{class:"search-icon"},"ðŸ”",-1)),k(e("input",{"onUpdate:modelValue":o[0]||(o[0]=u=>w.value=u),type:"text",placeholder:t(l)("admin.search_placeholder"),class:"input-field search-input"},null,8,Je),[[x,w.value]])]),e("span",Qe,a(z.value.length)+" "+a(t(l)("admin.product")),1)]),e("div",Xe,[C.value?(c(),v("div",Ke,[V(D,{size:"lg",color:"var(--primary)"}),e("p",null,a(t(l)("admin.loading_data")),1)])):z.value.length===0?(c(),v("div",Ye,[o[8]||(o[8]=e("div",{class:"empty-icon"},"ðŸ“¦",-1)),e("h3",null,a(t(l)("admin.no_products")),1),e("p",null,a(t(l)("admin.no_products")),1),e("button",{class:"btn btn-primary",onClick:j},a(t(l)("admin.add_product")),1)])):(c(),v("table",Ze,[e("thead",null,[e("tr",null,[e("th",null,a(t(l)("admin.product")),1),e("th",null,a(t(l)("admin.brand")),1),e("th",null,a(t(l)("admin.category")),1),e("th",null,a(t(l)("admin.price")),1),e("th",null,a(t(l)("admin.stock")),1),e("th",null,a(t(l)("admin.rating")),1),e("th",null,a(t(l)("admin.actions")),1)])]),e("tbody",null,[(c(!0),v(B,null,F(z.value,u=>(c(),v("tr",{key:u.id,class:"product-row"},[e("td",null,[e("div",et,[e("img",{src:u.image_url,alt:u.name,class:"product-thumb"},null,8,tt),e("div",null,[e("span",at,a(u.name),1),e("span",lt,"#"+a(u.id),1)])])]),e("td",null,a(u.brand?.name||"-"),1),e("td",null,a(u.category?.name||"-"),1),e("td",nt,a(t(l)("common.currency"))+" "+a(u.price.toLocaleString()),1),e("td",null,[e("span",{class:P(["stock-badge",{low:u.stock<30}])},a(u.stock),3)]),e("td",null,[e("span",ot,"â­ "+a(u.rating||"-"),1)]),e("td",null,[e("div",st,[e("button",{class:"action-btn edit",title:t(l)("admin.edit"),onClick:le=>N(u)},"âœï¸",8,it),e("button",{class:"action-btn delete",title:t(l)("admin.delete"),onClick:le=>ee(u)},"ðŸ—‘ï¸",8,dt)])])]))),128))])]))])]),V(W,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=u=>s.value=u),title:t(l)("admin.add_product"),size:"lg"},{default:I(()=>[V(O,{categories:y.value||[],brands:$.value||[],onSubmit:R,onCancel:o[1]||(o[1]=u=>s.value=!1)},null,8,["categories","brands"])]),_:1},8,["modelValue","title"]),V(W,{modelValue:n.value,"onUpdate:modelValue":o[4]||(o[4]=u=>n.value=u),title:t(l)("admin.edit"),size:"lg"},{default:I(()=>[V(O,{product:h.value,categories:y.value||[],brands:$.value||[],onSubmit:R,onCancel:o[3]||(o[3]=u=>n.value=!1)},null,8,["product","categories","brands"])]),_:1},8,["modelValue","title"]),V(ae,{modelValue:q.value,"onUpdate:modelValue":o[5]||(o[5]=u=>q.value=u),title:t(l)("admin.delete"),message:t(l)("admin.delete_confirm").replace("{name}",h.value?.name),"confirm-text":t(l)("admin.delete"),variant:"danger",onConfirm:te,onCancel:o[6]||(o[6]=u=>q.value=!1)},null,8,["modelValue","title","message","confirm-text"])])}}}),mt=L(ut,[["__scopeId","data-v-75e61992"]]);export{mt as default};
