import{_ as C}from"./B-8L2Q9z.js";import{_ as L}from"./CgFVh808.js";import{d as D,u as R,m as j,r as v,o as B,g as E,A as F,c as u,b as d,e as t,C as b,t as s,h as a,w as O,F as y,n as U,G as V,q as A,j as G}from"./CKlka8Zi.js";import"./Y6lJhnZ0.js";const I={class:"page-header"},N={class:"subtitle"},$={class:"flex gap-2"},q=["title"],z={class:"error-details"},M={class:"stats-row"},P={class:"stat-card"},T={class:"stat-value"},W={class:"stat-label"},H={class:"stat-card"},J={class:"stat-value"},K={class:"stat-label"},Q={class:"stat-card"},X={class:"stat-value"},Y={class:"stat-label"},Z={class:"table-container"},tt={class:"data-table"},at={class:"order-id"},et={class:"order-total"},st=["title"],nt=["title"],ot={key:0},lt={colspan:"6",style:{"text-align":"center",padding:"3rem",color:"var(--text-muted)"}},it=D({__name:"orders",setup(rt){const{translateLanguage:e,locale:g}=R(),x=j(),i=v([]),_=v(!0),r=v(null),m=async()=>{_.value=!0,r.value=null;try{const{data:l,error:n}=await x.getOrders();if(n.value){r.value=n.value;return}i.value=l.value||[]}catch(l){r.value=l}finally{_.value=!1}},S=()=>{m()};B(()=>{m(),E.from(".order-row",{x:-20,opacity:0,stagger:.05,duration:.4})});const w=l=>l?new Date(l).toLocaleString(g.value==="ar"?"ar-EG":g.value==="fr"?"fr-FR":"en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",f=F(()=>(i.value||[]).reduce((l,n)=>l+n.total_amount,0)||0),k=()=>{if(!i.value||i.value.length===0)return;const l=[e("admin.order_id"),e("admin.date"),e("admin.customer"),e("common.email"),e("common.total"),e("admin.status"),e("admin.payment")],n=i.value.map(c=>[c.id,new Date(c.created_at).toLocaleDateString(),`"${c.customer_name||e("admin.guest")}"`,c.customer_email||"-",c.total_amount,c.status,c.payment_status||"-"].join(",")),p=[l.join(","),...n].join(`
`),h=new Blob([p],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");o.href=URL.createObjectURL(h),o.download=`orders_${new Date().toISOString().slice(0,10)}.csv`,o.click()};return(l,n)=>{const p=C,h=L;return d(),u("div",null,[t("header",I,[t("div",null,[t("h1",null,s(a(e)("admin.orders_management")),1),t("p",N,s(a(e)("nav.admin_portal"))+" / "+s(a(e)("nav.orders")),1)]),t("div",$,[t("button",{class:"btn btn-outline",title:a(e)("admin.export_csv"),onClick:k},"ğŸ“¥ "+s(a(e)("admin.export_csv")),9,q)])]),a(_)?(d(),b(p,{key:0,message:a(e)("admin.loading_data")},null,8,["message"])):a(r)?(d(),b(h,{key:1,title:a(e)("admin.failed_load"),description:a(e)("common.error_desc"),retryable:!0,onRetry:S},{footer:O(()=>[t("div",z,s(a(r).message||a(r).statusText||a(r)),1)]),_:1},8,["title","description"])):(d(),u(y,{key:2},[t("div",M,[t("div",P,[n[0]||(n[0]=t("span",{class:"stat-icon"},"ğŸ“œ",-1)),t("div",null,[t("span",T,s(a(i).length),1),t("span",W,s(a(e)("nav.orders")),1)])]),t("div",H,[n[1]||(n[1]=t("span",{class:"stat-icon"},"ğŸ’°",-1)),t("div",null,[t("span",J,s(a(f).toLocaleString())+" "+s(a(e)("common.currency")),1),t("span",K,s(a(e)("admin.total_revenue")),1)])]),t("div",Q,[n[2]||(n[2]=t("span",{class:"stat-icon"},"ğŸ“ˆ",-1)),t("div",null,[t("span",X,s((a(i).length?a(f)/a(i).length:0).toLocaleString(void 0,{maximumFractionDigits:0}))+" "+s(a(e)("common.currency")),1),t("span",Y,s(a(e)("admin.average_value")),1)])])]),t("div",Z,[t("table",tt,[t("thead",null,[t("tr",null,[t("th",null,s(a(e)("admin.order_id")),1),t("th",null,s(a(e)("admin.date")),1),t("th",null,s(a(e)("admin.items")),1),t("th",null,s(a(e)("admin.price")),1),t("th",null,s(a(e)("admin.status")),1),t("th",null,s(a(e)("admin.actions")),1)])]),t("tbody",null,[(d(!0),u(y,null,V(a(i),o=>(d(),u("tr",{key:o.id,class:"order-row"},[t("td",at,"#"+s(o.id.toString().padStart(4,"0")),1),t("td",null,s(w(o.created_at)),1),t("td",null,s(o.items?.length||0)+" "+s(a(e)("admin.items")),1),t("td",et,s(o.total_amount.toLocaleString())+" "+s(a(e)("common.currency")),1),t("td",null,[t("span",{class:A(["status-badge",o.status.toLowerCase()])},s(o.status==="completed"?a(e)("admin.completed"):o.status==="pending"?a(e)("admin.pending"):o.status),3)]),t("td",null,[t("button",{class:"action-btn",title:a(e)("admin.view_details"),onClick:m},"ğŸ‘ï¸",8,st),t("button",{class:"action-btn",title:a(e)("admin.print_receipt"),onClick:m},"ğŸ–¨ï¸",8,nt)])]))),128)),a(i).length===0?(d(),u("tr",ot,[t("td",lt,s(a(e)("admin.no_data")),1)])):U("",!0)])])])],64))])}}}),_t=G(it,[["__scopeId","data-v-4ea111fc"]]);export{_t as default};
