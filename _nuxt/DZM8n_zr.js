import{d as x,u as C,m as q,l as M,X as L,r as v,o as S,c as p,b as _,e,n as h,t as n,h as l,F as $,G as B,D as y,s as u,v as r,f as D,Y as N,q as w,j as T}from"./CKlka8Zi.js";const A={class:"header"},F={class:"subtitle"},j={class:"table-container"},z={class:"data-table"},E=["title","onClick"],G={class:"modal"},I={class:"form-group"},X={class:"form-group"},Y={class:"form-group"},H={class:"form-group"},J={class:"form-group"},K={class:"form-group"},O={class:"form-group checkbox-group"},P={class:"form-actions"},Q=["disabled"],R=x({__name:"users",setup(W){const{translateLanguage:a}=C(),b=q(),k=M(),o=L(),g=v([]),m=v(!1),c=v(!1),i=v({username:"",first_name:"",last_name:"",email:"",phone_number:"",password:"",is_admin:!0,is_super_admin:!1}),f=async()=>{try{const{data:d,error:t}=await b.getUsers();if(t.value){o.error(a("admin.failed_load"));return}g.value=d.value||[]}catch{o.error(a("admin.failed_load"))}},U=async()=>{try{c.value=!0,await b.createUser(i.value),o.success(a("admin.save_success")),m.value=!1,i.value={username:"",first_name:"",last_name:"",email:"",phone_number:"",password:"",is_admin:!0,is_super_admin:!1},await f()}catch(d){o.error(d.response?._data?.detail||a("admin.save_failed"))}finally{c.value=!1}},V=async d=>{if(confirm(a("admin.delete_confirm")))try{await b.deleteUser(d),o.success(a("admin.delete_success")),await f()}catch(t){o.error(t.response?._data?.detail||a("admin.failed_load"))}};return S(()=>{f()}),(d,t)=>(_(),p("div",null,[e("div",null,[e("div",A,[e("div",null,[e("h1",null,n(l(a)("admin.users_management")),1),e("p",F,n(l(a)("nav.admin_portal"))+" / "+n(l(a)("nav.users")),1)]),l(k).user?.is_super_admin?(_(),p("button",{key:0,class:"btn btn-primary",onClick:t[0]||(t[0]=s=>m.value=!0)},"+ "+n(l(a)("admin.add_admin")),1)):h("",!0)]),e("div",j,[e("table",z,[e("thead",null,[e("tr",null,[e("th",null,n(l(a)("admin.name")),1),e("th",null,n(l(a)("admin.username")),1),e("th",null,n(l(a)("admin.email")),1),e("th",null,n(l(a)("admin.phone_number")),1),e("th",null,n(l(a)("admin.role")),1),e("th",null,n(l(a)("admin.status")),1),e("th",null,n(l(a)("admin.actions")),1)])]),e("tbody",null,[(_(!0),p($,null,B(g.value,s=>(_(),p("tr",{key:s.id},[e("td",null,n(s.first_name)+" "+n(s.last_name),1),e("td",null,n(s.username),1),e("td",null,n(s.email),1),e("td",null,n(s.phone_number),1),e("td",null,[e("span",{class:w(["badge",s.is_super_admin?"badge-purple":"badge-blue"])},n(s.is_super_admin?l(a)("admin.super_admin"):l(a)("admin.admin")),3)]),e("td",null,[e("span",{class:w(["badge",s.is_active?"badge-success":"badge-danger"])},n(s.is_active?l(a)("admin.active"):l(a)("admin.inactive")),3)]),e("td",null,[e("button",{class:"btn-icon text-danger",title:l(a)("admin.delete"),onClick:Z=>V(s.id)}," ðŸ—‘ï¸ ",8,E)])]))),128))])])]),m.value?(_(),p("div",{key:0,class:"modal-overlay",onClick:t[9]||(t[9]=y(s=>m.value=!1,["self"]))},[e("div",G,[e("h2",null,n(l(a)("admin.users_management")),1),e("form",{class:"form-grid",onSubmit:y(U,["prevent"])},[e("div",I,[e("label",null,n(l(a)("admin.username")),1),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.username=s),required:"",class:"input"},null,512),[[r,i.value.username]])]),e("div",X,[e("label",null,n(l(a)("admin.password")),1),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.password=s),type:"password",required:"",class:"input"},null,512),[[r,i.value.password]])]),e("div",Y,[e("label",null,n(l(a)("admin.first_name")),1),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.value.first_name=s),required:"",class:"input"},null,512),[[r,i.value.first_name]])]),e("div",H,[e("label",null,n(l(a)("admin.last_name")),1),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.value.last_name=s),required:"",class:"input"},null,512),[[r,i.value.last_name]])]),e("div",J,[e("label",null,n(l(a)("admin.email")),1),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>i.value.email=s),type:"email",required:"",class:"input"},null,512),[[r,i.value.email]])]),e("div",K,[e("label",null,n(l(a)("admin.phone_number")),1),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.value.phone_number=s),required:"",class:"input"},null,512),[[r,i.value.phone_number]])]),e("div",O,[e("label",null,[u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>i.value.is_super_admin=s),type:"checkbox"},null,512),[[N,i.value.is_super_admin]]),D(" "+n(l(a)("admin.set_as_super_admin")),1)])]),e("div",P,[e("button",{type:"button",class:"btn btn-outline",onClick:t[8]||(t[8]=s=>m.value=!1)},n(l(a)("admin.cancel")),1),e("button",{type:"submit",class:"btn btn-primary",disabled:c.value},n(c.value?l(a)("admin.uploading"):l(a)("admin.add_admin")),9,Q)])],32)])])):h("",!0)])]))}}),ae=T(R,[["__scopeId","data-v-12c9a332"]]);export{ae as default};
