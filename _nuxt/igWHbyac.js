import{_ as X}from"./B-8L2Q9z.js";import{_ as J}from"./CgFVh808.js";import{d as K,z as O,m as U,l as Y,u as Z,X as tt,A as d,B as st,r as R,$ as et,a as at,o as ot,g as k,c as i,b as n,C as w,h as t,a0 as nt,w as _,e as s,t as a,n as g,i as $,f as C,_ as ct,F as h,G as x,q as V,j as it}from"./CKlka8Zi.js";import{u as rt}from"./0Wg8tm4p.js";import"./Y6lJhnZ0.js";const lt={class:"pdp-wrapper"},dt={class:"error-details"},ut={key:2,class:"pdp-page"},_t={class:"container"},pt={class:"breadcrumbs"},mt={class:"current"},vt={class:"product-main"},gt={class:"product-gallery"},ht={class:"main-image"},yt=["src","alt"],bt={class:"thumbnails"},ft=["onClick"],kt=["src","alt"],wt={class:"product-details"},Ct={class:"product-header"},xt={key:0,class:"brand"},$t={class:"header-main"},St={class:"rating-review"},qt={class:"stars"},Lt={key:0},At={class:"review-count"},Et={class:"price-section"},Pt={class:"price"},Tt={class:"description"},Nt={key:0,class:"actions-wrapper"},Bt={class:"qty-selector-pdp"},Rt={class:"qty-controls"},Vt=["disabled"],It={class:"qty-value"},Mt=["disabled"],zt={class:"actions"},Ft={key:1,class:"actions"},Qt={class:"btn btn-lg btn-primary add-cart-btn",disabled:""},Wt={key:2,class:"specs-section"},jt={class:"specs-grid"},Dt={key:0,class:"related-products"},Gt={class:"related-grid"},Ht={class:"related-image"},Xt=["src","alt"],Jt={class:"related-info"},Kt={class:"related-price"},Ot={class:"store-cta-section"},Ut={class:"cta-content"},Yt=K({__name:"[id]",async setup(Zt){let y,S;const I=O(),q=U(),{addToCart:M}=rt(),L=Y(),{translateLanguage:o}=Z(),{success:z}=tt(),F=d(()=>L.user?.is_admin||L.user?.is_super_admin),A=([y,S]=st(()=>Promise.all([q.getProduct(Number(I.params.id)),q.getProducts()])),y=await y,S(),y),{data:e,pending:E,error:P}=A[0],{data:T}=A[1],p=d(()=>P.value),b=R(""),u=R(1),Q=()=>{e.value&&u.value<(e.value.stock||0)&&u.value++},W=()=>{u.value>1&&u.value--};et(()=>{e.value&&e.value.image_url&&(b.value=e.value.image_url)});const N=d(()=>!T.value||!e.value?[]:T.value.filter(r=>r.category_id===e.value?.category_id&&r.id!==e.value?.id).slice(0,4)),j=r=>{b.value=r,k.fromTo(".main-image img",{opacity:.5},{opacity:1,duration:.3})},D=()=>{if(!e.value)return;const r={...e.value,image_url:e.value.image_url||"",stock:e.value.stock||0};M(r,u.value),z(`${e.value.name} ${o("pdp.added_to_cart")}`)},B=d(()=>{const r=e.value?.rating||0,l=Math.floor(r),f=r%1>=.5?1:0;return{full:l,half:f,empty:5-l-f}}),G=()=>{window.location.reload()};return at({title:d(()=>e.value?`${e.value.name} | Maison El Wali`:o("pdp.details")),meta:[{name:"description",content:d(()=>e.value?.description||o("pdp.details"))},{property:"og:title",content:d(()=>e.value?.name)},{property:"og:description",content:d(()=>e.value?.description)},{property:"og:image",content:d(()=>e.value?.image_url)},{name:"twitter:card",content:"summary_large_image"}]}),ot(()=>{!E.value&&!P.value&&e.value&&(k.from(".product-gallery",{x:-50,opacity:0,duration:.6,ease:"power2.out"}),k.from(".product-details",{x:50,opacity:0,duration:.6,ease:"power2.out",delay:.1}),k.from(".related-card",{y:30,opacity:0,stagger:.1,duration:.5,delay:.3}))}),(r,l)=>{const f=X,H=J,m=ct;return n(),i("div",lt,[t(E)?(n(),w(f,{key:0,message:t(o)("pdp.loading")},null,8,["message"])):t(p)||!t(e)?(n(),w(H,{key:1,icon:"⚠️",title:t(o)("pdp.not_found"),description:t(o)("pdp.not_found_desc"),retryable:!0,onRetry:G},nt({_:2},[t(p)?{name:"footer",fn:_(()=>[s("div",dt,a(t(p).message||t(p).statusText||t(p)),1)]),key:"0"}:void 0]),1032,["title","description"])):(n(),i("div",ut,[s("div",_t,[s("nav",pt,[$(m,{to:"/"},{default:_(()=>[C(a(t(o)("pdp.home")),1)]),_:1}),l[0]||(l[0]=s("span",{class:"separator"},"/",-1)),$(m,{to:"/catalog"},{default:_(()=>[C(a(t(o)("pdp.catalog")),1)]),_:1}),l[1]||(l[1]=s("span",{class:"separator"},"/",-1)),s("span",mt,a(t(e).name),1)]),s("div",vt,[s("div",gt,[s("div",ht,[s("img",{src:t(b),alt:t(e).name},null,8,yt)]),s("div",bt,[(n(!0),i(h,null,x([t(e).image_url,...t(e).additional_images||[]],(c,v)=>(n(),i("button",{key:v,class:V(["thumb-btn",{active:t(b)===c}]),onClick:ts=>c&&j(c)},[s("img",{src:c,alt:`${t(e).name} view ${v+1}`},null,8,kt)],10,ft))),128))])]),s("div",wt,[s("div",Ct,[t(e).brand?(n(),i("span",xt,a(t(e).brand.name),1)):g("",!0),s("div",$t,[s("h1",null,a(t(e).name),1),t(F)?(n(),w(m,{key:0,to:`/admin/products?id=${t(e).id}`,class:"btn btn-sm btn-outline edit-btn"},{default:_(()=>[C(" ✏️ "+a(t(o)("admin.edit")||"Edit"),1)]),_:1},8,["to"])):g("",!0)]),s("div",St,[s("div",qt,[(n(!0),i(h,null,x(t(B).full,c=>(n(),i("span",{key:`full-${c}`},"⭐"))),128)),t(B).half?(n(),i("span",Lt,"⭐️")):g("",!0)]),s("span",At,"("+a(t(e).review_count||0)+" "+a(t(o)("pdp.reviews"))+")",1)])]),s("div",Et,[s("span",Pt,a(t(e).price.toLocaleString())+" "+a(t(o)("common.currency")),1),s("span",{class:V(["stock-status",{"in-stock":t(e).stock>0,"out-stock":t(e).stock===0}])},a(t(e).stock>0?t(o)("pdp.in_stock"):t(o)("pdp.out_stock")),3)]),s("p",Tt,a(t(e).description),1),t(e).stock>0?(n(),i("div",Nt,[s("div",Bt,[s("label",null,a(t(o)("pdp.quantity")),1),s("div",Rt,[s("button",{class:"qty-btn",disabled:t(u)<=1,onClick:W},"−",8,Vt),s("span",It,a(t(u)),1),s("button",{class:"qty-btn",disabled:t(u)>=t(e).stock,onClick:Q},"+",8,Mt)])]),s("div",zt,[s("button",{class:"btn btn-lg btn-primary add-cart-btn",onClick:D},a(t(o)("pdp.add_to_cart")),1),l[2]||(l[2]=s("button",{class:"btn btn-lg btn-outline wishlist-btn"}," ❤️ ",-1))])])):(n(),i("div",Ft,[s("button",Qt,a(t(o)("pdp.out_stock")),1)])),t(e).specs?(n(),i("div",Wt,[s("h3",null,a(t(o)("pdp.specs")),1),s("dl",jt,[(n(!0),i(h,null,x(t(e).specs,(c,v)=>(n(),i(h,{key:v},[s("dt",null,a(String(v).replace(/_/g," ")),1),s("dd",null,a(c),1)],64))),128))])])):g("",!0)])]),t(N).length>0?(n(),i("section",Dt,[s("h2",null,a(t(o)("pdp.related")),1),s("div",Gt,[(n(!0),i(h,null,x(t(N),c=>(n(),w(m,{key:c.id,to:`/product/${c.id}`,class:"related-card"},{default:_(()=>[s("div",Ht,[s("img",{src:c.image_url,alt:c.name},null,8,Xt)]),s("div",Jt,[s("h4",null,a(c.name),1),s("span",Kt,a(c.price.toLocaleString())+" "+a(t(o)("common.currency")),1)])]),_:2},1032,["to"]))),128))])])):g("",!0),s("section",Ot,[s("div",Ut,[s("h2",null,a(t(o)("stores.experience_person")),1),s("p",null,a(t(o)("stores.experience_desc")),1),$(m,{to:"/stores",class:"btn btn-primary"},{default:_(()=>[C(a(t(o)("about.find_store")),1)]),_:1})])])])]))])}}}),cs=it(Yt,[["__scopeId","data-v-e299a9d3"]]);export{cs as default};
